import { EnumSharepoint } from '../../enum/enumSharepoint';
import { Log } from '@microsoft/sp-core-library'


export interface SharepointState {
    error: string;
    userName: string;
  }


const initialState: SharepointState = {
    error: '',
    userName: ''
};
const SharepointReducer = (state = initialState, action: any):SharepointState => {
   
    switch (action.type) {
        case EnumSharepoint.GET_USER_CURRENT:
            Log.warn('SharepointReducer-GET_USER_CURRENT', JSON.stringify(action));
            return {
                ...state,
                userName: action.payload.Title,
            };
        case EnumSharepoint.ERROR_SHAREPOINT:
            Log.warn('SharepointReducer-ERROR_SHAREPOINT', JSON.stringify(action));
            return {
                ...state,
                userName: action.payload.Title,
                error: action.payload.Error
                };
        default:
            Log.warn('SharepointReducer-default', JSON.stringify(action));
            return state;
    }
};


export default SharepointReducer;
