import { Dispatch } from "redux";
import { EnumSharepoint } from "../../enum/enumSharepoint";
import SharepointService from "../../service/SharepointService";
import { Log } from "@microsoft/sp-core-library";

export const getUserCurrent = () => {
  return async (dispatch: Dispatch) => {
    try {
      const title = (await SharepointService.getCurrentUser()).Title;
      dispatch({
        type: EnumSharepoint.GET_USER_CURRENT,
        payload: { Title: title },
      });
    } catch (error) {
      Log.warn("Error - getCurrentUser", error?.message);
      dispatch({
        type: EnumSharepoint.ERROR_SHAREPOINT,
        payload: { Error: error?.message },
      });
    }
  };
};
